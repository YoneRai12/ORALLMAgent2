<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Session Viewer</title>
  <link rel="manifest" href="/manifest.webmanifest" />
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js');
    }
  </script>
  <style>img{max-width:100%;display:block;margin:auto;}</style>
</head>
<body>
  <input id="token" placeholder="JWT token" size="50" />
  <input id="session" placeholder="session id" />
  <button id="connect">Connect</button>
  <button id="disconnect">Disconnect</button>
  <div><img id="view" /></div>
  <script>
    let ws;
    const connectBtn=document.getElementById('connect');
    const disconnectBtn=document.getElementById('disconnect');
    connectBtn.onclick=()=>{
      const token=document.getElementById('token').value;
      const sess=document.getElementById('session').value;
      ws=new WebSocket(`ws://${location.host}/ws/stream/${sess}?token=${token}`);
      ws.binaryType='blob';
      ws.onmessage=(ev)=>{document.getElementById('view').src=URL.createObjectURL(ev.data);};
    };
    disconnectBtn.onclick=()=>{if(ws) ws.close();};
  </script>
</body>
</html>
